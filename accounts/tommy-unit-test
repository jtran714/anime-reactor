from fastapi.testclient import TestClient
from main import app
from queries.accounts import AccountQueries
from routers import auth

client = TestClient(app)

userDb = {
    "id": "1",
    "user_id": "2",
    "title": "Naruto",
    "date": "",
    "img_url": "",
}

class MockWatchlistRepository:
    def get_all(self, user_id: int):
        return [{'id': 1, 'name': 'Test watchlist'}]

def test_get_watchlist():
    app.dependency_overrides[router.WatchlistRepository] = MockWatchlistRepository
    app.dependency_overrides[router.authenticator.get_current_account_data] = lambda: {'id': 1}
    response = client.get("/api/watchlists/1")
    assert response.status_code == 200
    assert response.json() == {"watchlists": [{'id': 1, 'name': 'Test watchlist'}]}
    app.dependency_overrides = {}